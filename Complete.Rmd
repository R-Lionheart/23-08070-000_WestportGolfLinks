

```{r load_packages, include=FALSE, echo=FALSE, results='hide'}
## Load required packages
source("scripts/src/load_packages.R")
```


# The "BasePoint" reference line and Euclidean distance as an accretion/erosion proxy

```{r profiles_BasePoint, echo=FALSE}
source("scripts/profiles_and_BasePoint.R")
print(all.basepoint.plot)
print(single.basepoint.plot)
```


Using Euclidean distance, migrations of the transects over time as compared to the BasePoint act as proxies for accretion and erosion. 

The midpoint of each transect is calculated to determine a single comparative point using the midpoint formula pictured below.

$$\left(\frac{x_1+x_2}{2}, \frac{y_1+y_2}{2}\right)$$

The Euclidean distance between the midpoint and the fixed BasePoint is calculated for each transect and each year, resulting in an increasing or decreasing Euclidean distance. This distances correlates to an accreting or eroding transect.

$$d=\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$$

|                               |           |
|-------------------------------|-----------|
| Increasing Euclidean distance | Accretion |
| Decreasing Euclidean distance | Erosion   |

# Determining significance in accretion and erosion classifications for profiles. 

Apply the midpoint formula and distance formula to each transect/BasePoint pair, and plot the movement of the midpoint over time. This produces an x:y, distance:time relationship to which a linear model can be fitted. Once the linear model has been produced, the slope and p values can be extracted and used as respective indicators of transect characterization and significance. 

If the slope of a given distance:time relationship is positive, this indicates the distance between the transect midpoint and the BasePoint is increasing and the shoreline is accreting. If the slope is negative, the distance is decreasing and the shoreline is eroding. Linear models with a pvalue < 0.05 are considered significant.

```{r midpoint_euclidean, echo=FALSE}
profile.pattern <- "prof" 
source("scripts/midpoint_euclidean_distance.R")
midpoint.euc.dist.plot
```
    
    
# Quartile Points and Change Rates

Using the midpoint of each transect selects a single point as a proxy for erosion through time.
This can obscure the inherent variation in the collection of profiles.

The profiles have roughly linear relationships due to the geographic layout: in general, a change in x (moving along the Easting plane) will result in a *roughly* equal change in y (the Northing plane).
Therefore, a linear regression can be applied to the x and y variables of each profile to obtain a line proxy rather than a single point.

Below are images of a single profile and year to see the applied linear regression. In the first image, a linear regression is overlaid onto a single profile, and in the second, the linear quartiles of the regression are added. Note that in the second image, the red "BasePoint" has been included to visualize distance. 

These quartiles are labeled "minimum", "quartile1", "median", "quartile3", and "maximum" in accordance with standard boxplot parameters, although they are calculated using *only distance* and not boxplot delineations.

```{r single_linear_quartiles, echo=FALSE}
profile.pattern <- "prof_16"
year.pattern <- "00"

source("scripts/single_linear_quartiles.R")
single.linear.plot
single.quartiles.plot
```

Characterizing the profiles with more points allows for a more detailed look at erosion and accretion rates.

Each quartile's Euclidean movement is tracked over time, using the same calculations as the midpoint proxy used above. The rate of change is then calculated for each quartile of each profile, using a standard rate of change calculation between each year:

$$\frac{EucDist_2 - EucDist_1}{EucDist_1} \times 100\%$$
EucDist2 is the more recent year, and EucDist1 is the older year. This is calculated for each set of years from 1997 - 2022. 
For each profile, the average rate of change (ROC) between all quartiles is taken. 

```{r rates_of_change, echo=FALSE}
profile.pattern <- "prof_16"
source("scripts/rates_of_change.R")
profile.ROC.plot
annualized.median.plot
```
Westport Report Section 4.1 Results:
```{r ecology_transects, echo=FALSE}
source("scripts/distance_to_BP.R")
```

Westport Report Section 4.2 Results:
```{r satellite_transects, echo=FALSE}
source("scripts/Shoreline_change.R")
```
