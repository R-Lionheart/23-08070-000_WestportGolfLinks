---
title: "Westport Erosion Predictions"
author: "RLionheart"
format: pdf
editor: visual
---

## Overview here

*TODO Here I can give a quick overview of my thought process and methods*. An arbitrary baseline was drawn approximately 350m from shoreline. Each historical shoreline from 2006 to 2022 was measured to the baseline at six separate points, titled sites 1-6 heading north to south (see more detail below). All distance information is in meters. Using the historical imagery, change rates were calculated at all locations and extrapolated. From those extrapolations, erosion projections for 15 and 25 years were mapped onto the satellite images.

## Relevant images of a selection of sites

Below is a 2022 satellite image of Westport Light State Park. The white line is the arbitrary baseline, and the horizontal red lines indicate a selection of sample lines which trace the approximate distance from the baseline to the current shoreline.

![Westport Overview](figures/Westport_Overview.PNG)


------------------------------------------------------------------------

The North site, pictured below and located at approximately 46°54'6.84"N, 124° 7'54.29"W, was chosen due to proximity to nourishment provided by the Army Corps of Engineers. This nourishment, along with **TODO add more here TODO** historically limits erosion in this area.

![Sample Site One](figures/report_1.0/Site_One.PNG)

------------------------------------------------------------------------

The inflection point, pictured below in the red polygon and located at approximately 46°53'49.91"N, 124° 7'48.71"W, was chosen *by visual inspection only* at the location where active erosion appears to be mitigated by Corps nourishment, along with **TODO add interesting sciencey stuff here TODO**.

![Sample Site Two](figures/report_1.0/Site_Two.PNG)

------------------------------------------------------------------------

The South site, pictured below and located at approximately 46°53'13.57"N, 124° 7'34.81"W, was chosen due to proximity to dynamic revetment constructed in 2021. This site characterizes an area of higher erosion risk due to **TODO add stuff about revetment here TODO**.

![South Sample Site](images/South_Point.PNG)

------------------------------------------------------------------------

## Setup

```{r, output=FALSE}
#| echo: false
library(ggpubr)
library(tidyverse)
```

## Create data frames at each sampling position

Site One sample site measurements
```{r}
site.one <- data.frame(year =  c("2006", "2009", "2011", "2016", "2020", "2022"),
                    distance_m = c(322.55, 317.65, 311.69, 309.64, 316.66, 319.76), 
                    position = "one")
```

Site Two sample site measurements (inflection point)
```{r}
site.two <- data.frame(year =  c("2006", "2009", "2011", "2016", "2020", "2022"),
                         distance_m = c(328.97, 332.19, 333.04, 331.54, 335.62, 337.26), 
                         position = "two")
```

Site Three sample site measurements
```{r}
site.three <- data.frame(year =  c("2006", "2009", "2011", "2016", "2020", "2022"),
                         distance_m = c(324.20, 328.34, 328.67, 331.95, 337.12, 340.37), 
                         position = "three")
```

Site Four sample site measurements
```{r}
site.four <- data.frame(year =  c("2006", "2009", "2011", "2016", "2020", "2022"),
                         distance_m = c(316.12, 322.01, 323.54, 335.46, 339.06, 341.74), 
                         position = "four")
```

Site Five sample site measurements
```{r}
site.five <- data.frame(year =  c("2006", "2009", "2011", "2016", "2020", "2022"),
                         distance_m = c(301.69, 311.98, 310.65, 332.11, 336.56, 336.16), 
                         position = "five")
```

Site Six site measurements
```{r}
site.six <- data.frame(year = c("2006", "2009", "2011", "2016", "2020", "2022"),
                 distance_m = c(305.00, 308.49, 313.71, 338.23, 344.00, 348.42), 
                 position = "six")
```

Combine all locations to one data frame for calculations.

```{r}
distance_to_baseline <- site.one %>% 
  rbind(site.two, site.three, site.four, site.five, site.six)
distance_to_baseline$year <- factor(distance_to_baseline$year,
                                    levels = c("2006", "2009", "2011", "2016", "2020", "2022"))
distance_to_baseline$position <- factor(distance_to_baseline$position, 
                                        levels = c("one", "two", "three", "four", "five", "six"))
```

## Create plots

Plot distance by year

```{r}
distance.plot <- ggplot(distance_to_baseline, aes(group=position, y=distance_m, x=year, color=position)) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  scale_color_manual(values = c('#5C4E2C', '#395C51', "#036C88", "#36A886","#04A1FF", "#DBA827"), 
                     name = "Geographic location") +
  xlab("Year") + 
  ylab("Distance from Basepoint (m)") +
  ggtitle("Overall Distance (m)")
```

Calculate rates of change (ROC) at each location

```{r}
ROC <- distance_to_baseline %>% 
  group_by(position) %>% 
  arrange(position, year) %>% 
  mutate(rate = 100 * (distance_m - lag(distance_m))/lag(distance_m)) %>%
  drop_na()
```

Plot rates of change by year

```{r}
ROC.plot <- ggplot(data=ROC, aes(x=year, y=rate, group=position, color = position)) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  scale_color_manual(values = c('#5C4E2C', '#395C51', "#036C88", "#36A886","#04A1FF", "#DBA827"), 
                     name = "Geographic location") +
  xlab("Year") + 
  ylab("Rate of Change (m/year)") +
  ggtitle("Rate of Change (m/year)")
```

## Combine plots

```{r}
all.plots <- ggarrange(distance.plot, ROC.plot, common.legend = TRUE, legend="bottom")
annotate_figure(all.plots, top = text_grob("Shoreline Erosion at Westpoint Light State Park", 
                                      color = "black", face = "bold", size = 14))
```

## Predict 15-year and 25-year erosion rate

```{r}
distance_to_baseline$year <- as.numeric(as.character(distance_to_baseline$year))
prediction <- distance_to_baseline %>%
  group_by(position) %>%
  mutate(time_diff = max(year) - min(year),
         distance_diff = distance_m[year == 2022] - distance_m[year == 2006],
         m_change_per_year = round(distance_diff / time_diff),
         year_15_erosion = m_change_per_year * 15,
         year_25_erosion = m_change_per_year * 25) %>%
  select(position:year_25_erosion) %>%
  unique()
prediction <- prediction[order(prediction$position),]
prediction
```

The image below shows Westport Light State Park with the predicted 15- and 25-year erosion lines extrapolated from the calculated rates of change, along with a polygon citing the highest area of erosion risk from the shoreline armoring located in front of the Westport Condominiums.

![Projected Erosion](images/Projections.PNG)


## Additional calculations for headland protection and migration
Assuming a linear northern expansion of 1.5 m/year, a 2022 headland length of 11.96 m, and construction of the revetment in 2021, a table of *approximate* values are 
```{r}
headland.expansion <- data.frame(year =  c("2021", "2022", "2037", "2047"),
                                 expansion_m = c(0, 1.5, 22.5, 37.5), 
                                 headland.length = c(10.46, 11.96, 34.46, 49.46))
```

## Additional transects added between dyanmic revetment "headland" and inflection point.
Distance from inflection point to 2022 headland is 1.2 km. 

